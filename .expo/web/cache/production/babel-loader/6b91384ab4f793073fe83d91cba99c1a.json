{"ast":null,"code":"var Buffer=require('safe-buffer').Buffer;function asUInt32Array(buf){if(!Buffer.isBuffer(buf))buf=Buffer.from(buf);var len=buf.length/4|0;var out=new Array(len);for(var i=0;i<len;i++){out[i]=buf.readUInt32BE(i*4);}return out;}function scrubVec(v){for(var i=0;i<v.length;v++){v[i]=0;}}function cryptBlock(M,keySchedule,SUB_MIX,SBOX,nRounds){var SUB_MIX0=SUB_MIX[0];var SUB_MIX1=SUB_MIX[1];var SUB_MIX2=SUB_MIX[2];var SUB_MIX3=SUB_MIX[3];var s0=M[0]^keySchedule[0];var s1=M[1]^keySchedule[1];var s2=M[2]^keySchedule[2];var s3=M[3]^keySchedule[3];var t0,t1,t2,t3;var ksRow=4;for(var round=1;round<nRounds;round++){t0=SUB_MIX0[s0>>>24]^SUB_MIX1[s1>>>16&0xff]^SUB_MIX2[s2>>>8&0xff]^SUB_MIX3[s3&0xff]^keySchedule[ksRow++];t1=SUB_MIX0[s1>>>24]^SUB_MIX1[s2>>>16&0xff]^SUB_MIX2[s3>>>8&0xff]^SUB_MIX3[s0&0xff]^keySchedule[ksRow++];t2=SUB_MIX0[s2>>>24]^SUB_MIX1[s3>>>16&0xff]^SUB_MIX2[s0>>>8&0xff]^SUB_MIX3[s1&0xff]^keySchedule[ksRow++];t3=SUB_MIX0[s3>>>24]^SUB_MIX1[s0>>>16&0xff]^SUB_MIX2[s1>>>8&0xff]^SUB_MIX3[s2&0xff]^keySchedule[ksRow++];s0=t0;s1=t1;s2=t2;s3=t3;}t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&0xff]<<16|SBOX[s2>>>8&0xff]<<8|SBOX[s3&0xff])^keySchedule[ksRow++];t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&0xff]<<16|SBOX[s3>>>8&0xff]<<8|SBOX[s0&0xff])^keySchedule[ksRow++];t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&0xff]<<16|SBOX[s0>>>8&0xff]<<8|SBOX[s1&0xff])^keySchedule[ksRow++];t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&0xff]<<16|SBOX[s1>>>8&0xff]<<8|SBOX[s2&0xff])^keySchedule[ksRow++];t0=t0>>>0;t1=t1>>>0;t2=t2>>>0;t3=t3>>>0;return[t0,t1,t2,t3];}var RCON=[0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x1b,0x36];var G=function(){var d=new Array(256);for(var j=0;j<256;j++){if(j<128){d[j]=j<<1;}else{d[j]=j<<1^0x11b;}}var SBOX=[];var INV_SBOX=[];var SUB_MIX=[[],[],[],[]];var INV_SUB_MIX=[[],[],[],[]];var x=0;var xi=0;for(var i=0;i<256;++i){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sx=sx>>>8^sx&0xff^0x63;SBOX[x]=sx;INV_SBOX[sx]=x;var x2=d[x];var x4=d[x2];var x8=d[x4];var t=d[sx]*0x101^sx*0x1010100;SUB_MIX[0][x]=t<<24|t>>>8;SUB_MIX[1][x]=t<<16|t>>>16;SUB_MIX[2][x]=t<<8|t>>>24;SUB_MIX[3][x]=t;t=x8*0x1010101^x4*0x10001^x2*0x101^x*0x1010100;INV_SUB_MIX[0][sx]=t<<24|t>>>8;INV_SUB_MIX[1][sx]=t<<16|t>>>16;INV_SUB_MIX[2][sx]=t<<8|t>>>24;INV_SUB_MIX[3][sx]=t;if(x===0){x=xi=1;}else{x=x2^d[d[d[x8^x2]]];xi^=d[d[xi]];}}return{SBOX:SBOX,INV_SBOX:INV_SBOX,SUB_MIX:SUB_MIX,INV_SUB_MIX:INV_SUB_MIX};}();function AES(key){this._key=asUInt32Array(key);this._reset();}AES.blockSize=4*4;AES.keySize=256/8;AES.prototype.blockSize=AES.blockSize;AES.prototype.keySize=AES.keySize;AES.prototype._reset=function(){var keyWords=this._key;var keySize=keyWords.length;var nRounds=keySize+6;var ksRows=(nRounds+1)*4;var keySchedule=[];for(var k=0;k<keySize;k++){keySchedule[k]=keyWords[k];}for(k=keySize;k<ksRows;k++){var t=keySchedule[k-1];if(k%keySize===0){t=t<<8|t>>>24;t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&0xff]<<16|G.SBOX[t>>>8&0xff]<<8|G.SBOX[t&0xff];t^=RCON[k/keySize|0]<<24;}else if(keySize>6&&k%keySize===4){t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&0xff]<<16|G.SBOX[t>>>8&0xff]<<8|G.SBOX[t&0xff];}keySchedule[k]=keySchedule[k-keySize]^t;}var invKeySchedule=[];for(var ik=0;ik<ksRows;ik++){var ksR=ksRows-ik;var tt=keySchedule[ksR-(ik%4?0:4)];if(ik<4||ksR<=4){invKeySchedule[ik]=tt;}else{invKeySchedule[ik]=G.INV_SUB_MIX[0][G.SBOX[tt>>>24]]^G.INV_SUB_MIX[1][G.SBOX[tt>>>16&0xff]]^G.INV_SUB_MIX[2][G.SBOX[tt>>>8&0xff]]^G.INV_SUB_MIX[3][G.SBOX[tt&0xff]];}}this._nRounds=nRounds;this._keySchedule=keySchedule;this._invKeySchedule=invKeySchedule;};AES.prototype.encryptBlockRaw=function(M){M=asUInt32Array(M);return cryptBlock(M,this._keySchedule,G.SUB_MIX,G.SBOX,this._nRounds);};AES.prototype.encryptBlock=function(M){var out=this.encryptBlockRaw(M);var buf=Buffer.allocUnsafe(16);buf.writeUInt32BE(out[0],0);buf.writeUInt32BE(out[1],4);buf.writeUInt32BE(out[2],8);buf.writeUInt32BE(out[3],12);return buf;};AES.prototype.decryptBlock=function(M){M=asUInt32Array(M);var m1=M[1];M[1]=M[3];M[3]=m1;var out=cryptBlock(M,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX,this._nRounds);var buf=Buffer.allocUnsafe(16);buf.writeUInt32BE(out[0],0);buf.writeUInt32BE(out[3],4);buf.writeUInt32BE(out[2],8);buf.writeUInt32BE(out[1],12);return buf;};AES.prototype.scrub=function(){scrubVec(this._keySchedule);scrubVec(this._invKeySchedule);scrubVec(this._key);};module.exports.AES=AES;","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/browserify-aes/aes.js"],"names":["Buffer","require","asUInt32Array","buf","isBuffer","from","len","length","out","Array","i","readUInt32BE","scrubVec","v","cryptBlock","M","keySchedule","SUB_MIX","SBOX","nRounds","SUB_MIX0","SUB_MIX1","SUB_MIX2","SUB_MIX3","s0","s1","s2","s3","t0","t1","t2","t3","ksRow","round","RCON","G","d","j","INV_SBOX","INV_SUB_MIX","x","xi","sx","x2","x4","x8","t","AES","key","_key","_reset","blockSize","keySize","prototype","keyWords","ksRows","k","invKeySchedule","ik","ksR","tt","_nRounds","_keySchedule","_invKeySchedule","encryptBlockRaw","encryptBlock","allocUnsafe","writeUInt32BE","decryptBlock","m1","scrub","module","exports"],"mappings":"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","sourcesContent":["// based on the aes implimentation in triple sec\n// https://github.com/keybase/triplesec\n// which is in turn based on the one from crypto-js\n// https://code.google.com/p/crypto-js/\n\nvar Buffer = require('safe-buffer').Buffer\n\nfunction asUInt32Array (buf) {\n  if (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)\n\n  var len = (buf.length / 4) | 0\n  var out = new Array(len)\n\n  for (var i = 0; i < len; i++) {\n    out[i] = buf.readUInt32BE(i * 4)\n  }\n\n  return out\n}\n\nfunction scrubVec (v) {\n  for (var i = 0; i < v.length; v++) {\n    v[i] = 0\n  }\n}\n\nfunction cryptBlock (M, keySchedule, SUB_MIX, SBOX, nRounds) {\n  var SUB_MIX0 = SUB_MIX[0]\n  var SUB_MIX1 = SUB_MIX[1]\n  var SUB_MIX2 = SUB_MIX[2]\n  var SUB_MIX3 = SUB_MIX[3]\n\n  var s0 = M[0] ^ keySchedule[0]\n  var s1 = M[1] ^ keySchedule[1]\n  var s2 = M[2] ^ keySchedule[2]\n  var s3 = M[3] ^ keySchedule[3]\n  var t0, t1, t2, t3\n  var ksRow = 4\n\n  for (var round = 1; round < nRounds; round++) {\n    t0 = SUB_MIX0[s0 >>> 24] ^ SUB_MIX1[(s1 >>> 16) & 0xff] ^ SUB_MIX2[(s2 >>> 8) & 0xff] ^ SUB_MIX3[s3 & 0xff] ^ keySchedule[ksRow++]\n    t1 = SUB_MIX0[s1 >>> 24] ^ SUB_MIX1[(s2 >>> 16) & 0xff] ^ SUB_MIX2[(s3 >>> 8) & 0xff] ^ SUB_MIX3[s0 & 0xff] ^ keySchedule[ksRow++]\n    t2 = SUB_MIX0[s2 >>> 24] ^ SUB_MIX1[(s3 >>> 16) & 0xff] ^ SUB_MIX2[(s0 >>> 8) & 0xff] ^ SUB_MIX3[s1 & 0xff] ^ keySchedule[ksRow++]\n    t3 = SUB_MIX0[s3 >>> 24] ^ SUB_MIX1[(s0 >>> 16) & 0xff] ^ SUB_MIX2[(s1 >>> 8) & 0xff] ^ SUB_MIX3[s2 & 0xff] ^ keySchedule[ksRow++]\n    s0 = t0\n    s1 = t1\n    s2 = t2\n    s3 = t3\n  }\n\n  t0 = ((SBOX[s0 >>> 24] << 24) | (SBOX[(s1 >>> 16) & 0xff] << 16) | (SBOX[(s2 >>> 8) & 0xff] << 8) | SBOX[s3 & 0xff]) ^ keySchedule[ksRow++]\n  t1 = ((SBOX[s1 >>> 24] << 24) | (SBOX[(s2 >>> 16) & 0xff] << 16) | (SBOX[(s3 >>> 8) & 0xff] << 8) | SBOX[s0 & 0xff]) ^ keySchedule[ksRow++]\n  t2 = ((SBOX[s2 >>> 24] << 24) | (SBOX[(s3 >>> 16) & 0xff] << 16) | (SBOX[(s0 >>> 8) & 0xff] << 8) | SBOX[s1 & 0xff]) ^ keySchedule[ksRow++]\n  t3 = ((SBOX[s3 >>> 24] << 24) | (SBOX[(s0 >>> 16) & 0xff] << 16) | (SBOX[(s1 >>> 8) & 0xff] << 8) | SBOX[s2 & 0xff]) ^ keySchedule[ksRow++]\n  t0 = t0 >>> 0\n  t1 = t1 >>> 0\n  t2 = t2 >>> 0\n  t3 = t3 >>> 0\n\n  return [t0, t1, t2, t3]\n}\n\n// AES constants\nvar RCON = [0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36]\nvar G = (function () {\n  // Compute double table\n  var d = new Array(256)\n  for (var j = 0; j < 256; j++) {\n    if (j < 128) {\n      d[j] = j << 1\n    } else {\n      d[j] = (j << 1) ^ 0x11b\n    }\n  }\n\n  var SBOX = []\n  var INV_SBOX = []\n  var SUB_MIX = [[], [], [], []]\n  var INV_SUB_MIX = [[], [], [], []]\n\n  // Walk GF(2^8)\n  var x = 0\n  var xi = 0\n  for (var i = 0; i < 256; ++i) {\n    // Compute sbox\n    var sx = xi ^ (xi << 1) ^ (xi << 2) ^ (xi << 3) ^ (xi << 4)\n    sx = (sx >>> 8) ^ (sx & 0xff) ^ 0x63\n    SBOX[x] = sx\n    INV_SBOX[sx] = x\n\n    // Compute multiplication\n    var x2 = d[x]\n    var x4 = d[x2]\n    var x8 = d[x4]\n\n    // Compute sub bytes, mix columns tables\n    var t = (d[sx] * 0x101) ^ (sx * 0x1010100)\n    SUB_MIX[0][x] = (t << 24) | (t >>> 8)\n    SUB_MIX[1][x] = (t << 16) | (t >>> 16)\n    SUB_MIX[2][x] = (t << 8) | (t >>> 24)\n    SUB_MIX[3][x] = t\n\n    // Compute inv sub bytes, inv mix columns tables\n    t = (x8 * 0x1010101) ^ (x4 * 0x10001) ^ (x2 * 0x101) ^ (x * 0x1010100)\n    INV_SUB_MIX[0][sx] = (t << 24) | (t >>> 8)\n    INV_SUB_MIX[1][sx] = (t << 16) | (t >>> 16)\n    INV_SUB_MIX[2][sx] = (t << 8) | (t >>> 24)\n    INV_SUB_MIX[3][sx] = t\n\n    if (x === 0) {\n      x = xi = 1\n    } else {\n      x = x2 ^ d[d[d[x8 ^ x2]]]\n      xi ^= d[d[xi]]\n    }\n  }\n\n  return {\n    SBOX: SBOX,\n    INV_SBOX: INV_SBOX,\n    SUB_MIX: SUB_MIX,\n    INV_SUB_MIX: INV_SUB_MIX\n  }\n})()\n\nfunction AES (key) {\n  this._key = asUInt32Array(key)\n  this._reset()\n}\n\nAES.blockSize = 4 * 4\nAES.keySize = 256 / 8\nAES.prototype.blockSize = AES.blockSize\nAES.prototype.keySize = AES.keySize\nAES.prototype._reset = function () {\n  var keyWords = this._key\n  var keySize = keyWords.length\n  var nRounds = keySize + 6\n  var ksRows = (nRounds + 1) * 4\n\n  var keySchedule = []\n  for (var k = 0; k < keySize; k++) {\n    keySchedule[k] = keyWords[k]\n  }\n\n  for (k = keySize; k < ksRows; k++) {\n    var t = keySchedule[k - 1]\n\n    if (k % keySize === 0) {\n      t = (t << 8) | (t >>> 24)\n      t =\n        (G.SBOX[t >>> 24] << 24) |\n        (G.SBOX[(t >>> 16) & 0xff] << 16) |\n        (G.SBOX[(t >>> 8) & 0xff] << 8) |\n        (G.SBOX[t & 0xff])\n\n      t ^= RCON[(k / keySize) | 0] << 24\n    } else if (keySize > 6 && k % keySize === 4) {\n      t =\n        (G.SBOX[t >>> 24] << 24) |\n        (G.SBOX[(t >>> 16) & 0xff] << 16) |\n        (G.SBOX[(t >>> 8) & 0xff] << 8) |\n        (G.SBOX[t & 0xff])\n    }\n\n    keySchedule[k] = keySchedule[k - keySize] ^ t\n  }\n\n  var invKeySchedule = []\n  for (var ik = 0; ik < ksRows; ik++) {\n    var ksR = ksRows - ik\n    var tt = keySchedule[ksR - (ik % 4 ? 0 : 4)]\n\n    if (ik < 4 || ksR <= 4) {\n      invKeySchedule[ik] = tt\n    } else {\n      invKeySchedule[ik] =\n        G.INV_SUB_MIX[0][G.SBOX[tt >>> 24]] ^\n        G.INV_SUB_MIX[1][G.SBOX[(tt >>> 16) & 0xff]] ^\n        G.INV_SUB_MIX[2][G.SBOX[(tt >>> 8) & 0xff]] ^\n        G.INV_SUB_MIX[3][G.SBOX[tt & 0xff]]\n    }\n  }\n\n  this._nRounds = nRounds\n  this._keySchedule = keySchedule\n  this._invKeySchedule = invKeySchedule\n}\n\nAES.prototype.encryptBlockRaw = function (M) {\n  M = asUInt32Array(M)\n  return cryptBlock(M, this._keySchedule, G.SUB_MIX, G.SBOX, this._nRounds)\n}\n\nAES.prototype.encryptBlock = function (M) {\n  var out = this.encryptBlockRaw(M)\n  var buf = Buffer.allocUnsafe(16)\n  buf.writeUInt32BE(out[0], 0)\n  buf.writeUInt32BE(out[1], 4)\n  buf.writeUInt32BE(out[2], 8)\n  buf.writeUInt32BE(out[3], 12)\n  return buf\n}\n\nAES.prototype.decryptBlock = function (M) {\n  M = asUInt32Array(M)\n\n  // swap\n  var m1 = M[1]\n  M[1] = M[3]\n  M[3] = m1\n\n  var out = cryptBlock(M, this._invKeySchedule, G.INV_SUB_MIX, G.INV_SBOX, this._nRounds)\n  var buf = Buffer.allocUnsafe(16)\n  buf.writeUInt32BE(out[0], 0)\n  buf.writeUInt32BE(out[3], 4)\n  buf.writeUInt32BE(out[2], 8)\n  buf.writeUInt32BE(out[1], 12)\n  return buf\n}\n\nAES.prototype.scrub = function () {\n  scrubVec(this._keySchedule)\n  scrubVec(this._invKeySchedule)\n  scrubVec(this._key)\n}\n\nmodule.exports.AES = AES\n"]},"metadata":{},"sourceType":"script"}