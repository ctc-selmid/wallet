{"ast":null,"code":"'use strict';var utils=require(\"../utils\");var assert=utils.assert;var parseBytes=utils.parseBytes;var cachedProperty=utils.cachedProperty;function KeyPair(eddsa,params){this.eddsa=eddsa;this._secret=parseBytes(params.secret);if(eddsa.isPoint(params.pub))this._pub=params.pub;else this._pubBytes=parseBytes(params.pub);}KeyPair.fromPublic=function fromPublic(eddsa,pub){if(pub instanceof KeyPair)return pub;return new KeyPair(eddsa,{pub:pub});};KeyPair.fromSecret=function fromSecret(eddsa,secret){if(secret instanceof KeyPair)return secret;return new KeyPair(eddsa,{secret:secret});};KeyPair.prototype.secret=function secret(){return this._secret;};cachedProperty(KeyPair,'pubBytes',function pubBytes(){return this.eddsa.encodePoint(this.pub());});cachedProperty(KeyPair,'pub',function pub(){if(this._pubBytes)return this.eddsa.decodePoint(this._pubBytes);return this.eddsa.g.mul(this.priv());});cachedProperty(KeyPair,'privBytes',function privBytes(){var eddsa=this.eddsa;var hash=this.hash();var lastIx=eddsa.encodingLength-1;var a=hash.slice(0,eddsa.encodingLength);a[0]&=248;a[lastIx]&=127;a[lastIx]|=64;return a;});cachedProperty(KeyPair,'priv',function priv(){return this.eddsa.decodeInt(this.privBytes());});cachedProperty(KeyPair,'hash',function hash(){return this.eddsa.hash().update(this.secret()).digest();});cachedProperty(KeyPair,'messagePrefix',function messagePrefix(){return this.hash().slice(this.eddsa.encodingLength);});KeyPair.prototype.sign=function sign(message){assert(this._secret,'KeyPair can only verify');return this.eddsa.sign(message,this);};KeyPair.prototype.verify=function verify(message,sig){return this.eddsa.verify(message,sig,this);};KeyPair.prototype.getSecret=function getSecret(enc){assert(this._secret,'KeyPair is public only');return utils.encode(this.secret(),enc);};KeyPair.prototype.getPublic=function getPublic(enc){return utils.encode(this.pubBytes(),enc);};module.exports=KeyPair;","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/elliptic/lib/elliptic/eddsa/key.js"],"names":["utils","require","assert","parseBytes","cachedProperty","KeyPair","eddsa","params","_secret","secret","isPoint","pub","_pub","_pubBytes","fromPublic","fromSecret","prototype","pubBytes","encodePoint","decodePoint","g","mul","priv","privBytes","hash","lastIx","encodingLength","a","slice","decodeInt","update","digest","messagePrefix","sign","message","verify","sig","getSecret","enc","encode","getPublic","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar utils = require('../utils');\nvar assert = utils.assert;\nvar parseBytes = utils.parseBytes;\nvar cachedProperty = utils.cachedProperty;\n\n/**\n* @param {EDDSA} eddsa - instance\n* @param {Object} params - public/private key parameters\n*\n* @param {Array<Byte>} [params.secret] - secret seed bytes\n* @param {Point} [params.pub] - public key point (aka `A` in eddsa terms)\n* @param {Array<Byte>} [params.pub] - public key point encoded as bytes\n*\n*/\nfunction KeyPair(eddsa, params) {\n  this.eddsa = eddsa;\n  this._secret = parseBytes(params.secret);\n  if (eddsa.isPoint(params.pub))\n    this._pub = params.pub;\n  else\n    this._pubBytes = parseBytes(params.pub);\n}\n\nKeyPair.fromPublic = function fromPublic(eddsa, pub) {\n  if (pub instanceof KeyPair)\n    return pub;\n  return new KeyPair(eddsa, { pub: pub });\n};\n\nKeyPair.fromSecret = function fromSecret(eddsa, secret) {\n  if (secret instanceof KeyPair)\n    return secret;\n  return new KeyPair(eddsa, { secret: secret });\n};\n\nKeyPair.prototype.secret = function secret() {\n  return this._secret;\n};\n\ncachedProperty(KeyPair, 'pubBytes', function pubBytes() {\n  return this.eddsa.encodePoint(this.pub());\n});\n\ncachedProperty(KeyPair, 'pub', function pub() {\n  if (this._pubBytes)\n    return this.eddsa.decodePoint(this._pubBytes);\n  return this.eddsa.g.mul(this.priv());\n});\n\ncachedProperty(KeyPair, 'privBytes', function privBytes() {\n  var eddsa = this.eddsa;\n  var hash = this.hash();\n  var lastIx = eddsa.encodingLength - 1;\n\n  var a = hash.slice(0, eddsa.encodingLength);\n  a[0] &= 248;\n  a[lastIx] &= 127;\n  a[lastIx] |= 64;\n\n  return a;\n});\n\ncachedProperty(KeyPair, 'priv', function priv() {\n  return this.eddsa.decodeInt(this.privBytes());\n});\n\ncachedProperty(KeyPair, 'hash', function hash() {\n  return this.eddsa.hash().update(this.secret()).digest();\n});\n\ncachedProperty(KeyPair, 'messagePrefix', function messagePrefix() {\n  return this.hash().slice(this.eddsa.encodingLength);\n});\n\nKeyPair.prototype.sign = function sign(message) {\n  assert(this._secret, 'KeyPair can only verify');\n  return this.eddsa.sign(message, this);\n};\n\nKeyPair.prototype.verify = function verify(message, sig) {\n  return this.eddsa.verify(message, sig, this);\n};\n\nKeyPair.prototype.getSecret = function getSecret(enc) {\n  assert(this._secret, 'KeyPair is public only');\n  return utils.encode(this.secret(), enc);\n};\n\nKeyPair.prototype.getPublic = function getPublic(enc) {\n  return utils.encode(this.pubBytes(), enc);\n};\n\nmodule.exports = KeyPair;\n"]},"metadata":{},"sourceType":"script"}