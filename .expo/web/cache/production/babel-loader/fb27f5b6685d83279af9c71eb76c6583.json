{"ast":null,"code":"'use strict';var BN=require('bn.js');var utils=require(\"../utils\");var assert=utils.assert;function Signature(options,enc){if(options instanceof Signature)return options;if(this._importDER(options,enc))return;assert(options.r&&options.s,'Signature without r or s');this.r=new BN(options.r,16);this.s=new BN(options.s,16);if(options.recoveryParam===undefined)this.recoveryParam=null;else this.recoveryParam=options.recoveryParam;}module.exports=Signature;function Position(){this.place=0;}function getLength(buf,p){var initial=buf[p.place++];if(!(initial&0x80)){return initial;}var octetLen=initial&0xf;if(octetLen===0||octetLen>4){return false;}var val=0;for(var i=0,off=p.place;i<octetLen;i++,off++){val<<=8;val|=buf[off];val>>>=0;}if(val<=0x7f){return false;}p.place=off;return val;}function rmPadding(buf){var i=0;var len=buf.length-1;while(!buf[i]&&!(buf[i+1]&0x80)&&i<len){i++;}if(i===0){return buf;}return buf.slice(i);}Signature.prototype._importDER=function _importDER(data,enc){data=utils.toArray(data,enc);var p=new Position();if(data[p.place++]!==0x30){return false;}var len=getLength(data,p);if(len===false){return false;}if(len+p.place!==data.length){return false;}if(data[p.place++]!==0x02){return false;}var rlen=getLength(data,p);if(rlen===false){return false;}var r=data.slice(p.place,rlen+p.place);p.place+=rlen;if(data[p.place++]!==0x02){return false;}var slen=getLength(data,p);if(slen===false){return false;}if(data.length!==slen+p.place){return false;}var s=data.slice(p.place,slen+p.place);if(r[0]===0){if(r[1]&0x80){r=r.slice(1);}else{return false;}}if(s[0]===0){if(s[1]&0x80){s=s.slice(1);}else{return false;}}this.r=new BN(r);this.s=new BN(s);this.recoveryParam=null;return true;};function constructLength(arr,len){if(len<0x80){arr.push(len);return;}var octets=1+(Math.log(len)/Math.LN2>>>3);arr.push(octets|0x80);while(--octets){arr.push(len>>>(octets<<3)&0xff);}arr.push(len);}Signature.prototype.toDER=function toDER(enc){var r=this.r.toArray();var s=this.s.toArray();if(r[0]&0x80)r=[0].concat(r);if(s[0]&0x80)s=[0].concat(s);r=rmPadding(r);s=rmPadding(s);while(!s[0]&&!(s[1]&0x80)){s=s.slice(1);}var arr=[0x02];constructLength(arr,r.length);arr=arr.concat(r);arr.push(0x02);constructLength(arr,s.length);var backHalf=arr.concat(s);var res=[0x30];constructLength(res,backHalf.length);res=res.concat(backHalf);return utils.encode(res,enc);};","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/elliptic/lib/elliptic/ec/signature.js"],"names":["BN","require","utils","assert","Signature","options","enc","_importDER","r","s","recoveryParam","undefined","module","exports","Position","place","getLength","buf","p","initial","octetLen","val","i","off","rmPadding","len","length","slice","prototype","data","toArray","rlen","slen","constructLength","arr","push","octets","Math","log","LN2","toDER","concat","backHalf","res","encode"],"mappings":"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","sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\n\nvar utils = require('../utils');\nvar assert = utils.assert;\n\nfunction Signature(options, enc) {\n  if (options instanceof Signature)\n    return options;\n\n  if (this._importDER(options, enc))\n    return;\n\n  assert(options.r && options.s, 'Signature without r or s');\n  this.r = new BN(options.r, 16);\n  this.s = new BN(options.s, 16);\n  if (options.recoveryParam === undefined)\n    this.recoveryParam = null;\n  else\n    this.recoveryParam = options.recoveryParam;\n}\nmodule.exports = Signature;\n\nfunction Position() {\n  this.place = 0;\n}\n\nfunction getLength(buf, p) {\n  var initial = buf[p.place++];\n  if (!(initial & 0x80)) {\n    return initial;\n  }\n  var octetLen = initial & 0xf;\n\n  // Indefinite length or overflow\n  if (octetLen === 0 || octetLen > 4) {\n    return false;\n  }\n\n  var val = 0;\n  for (var i = 0, off = p.place; i < octetLen; i++, off++) {\n    val <<= 8;\n    val |= buf[off];\n    val >>>= 0;\n  }\n\n  // Leading zeroes\n  if (val <= 0x7f) {\n    return false;\n  }\n\n  p.place = off;\n  return val;\n}\n\nfunction rmPadding(buf) {\n  var i = 0;\n  var len = buf.length - 1;\n  while (!buf[i] && !(buf[i + 1] & 0x80) && i < len) {\n    i++;\n  }\n  if (i === 0) {\n    return buf;\n  }\n  return buf.slice(i);\n}\n\nSignature.prototype._importDER = function _importDER(data, enc) {\n  data = utils.toArray(data, enc);\n  var p = new Position();\n  if (data[p.place++] !== 0x30) {\n    return false;\n  }\n  var len = getLength(data, p);\n  if (len === false) {\n    return false;\n  }\n  if ((len + p.place) !== data.length) {\n    return false;\n  }\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var rlen = getLength(data, p);\n  if (rlen === false) {\n    return false;\n  }\n  var r = data.slice(p.place, rlen + p.place);\n  p.place += rlen;\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var slen = getLength(data, p);\n  if (slen === false) {\n    return false;\n  }\n  if (data.length !== slen + p.place) {\n    return false;\n  }\n  var s = data.slice(p.place, slen + p.place);\n  if (r[0] === 0) {\n    if (r[1] & 0x80) {\n      r = r.slice(1);\n    } else {\n      // Leading zeroes\n      return false;\n    }\n  }\n  if (s[0] === 0) {\n    if (s[1] & 0x80) {\n      s = s.slice(1);\n    } else {\n      // Leading zeroes\n      return false;\n    }\n  }\n\n  this.r = new BN(r);\n  this.s = new BN(s);\n  this.recoveryParam = null;\n\n  return true;\n};\n\nfunction constructLength(arr, len) {\n  if (len < 0x80) {\n    arr.push(len);\n    return;\n  }\n  var octets = 1 + (Math.log(len) / Math.LN2 >>> 3);\n  arr.push(octets | 0x80);\n  while (--octets) {\n    arr.push((len >>> (octets << 3)) & 0xff);\n  }\n  arr.push(len);\n}\n\nSignature.prototype.toDER = function toDER(enc) {\n  var r = this.r.toArray();\n  var s = this.s.toArray();\n\n  // Pad values\n  if (r[0] & 0x80)\n    r = [ 0 ].concat(r);\n  // Pad values\n  if (s[0] & 0x80)\n    s = [ 0 ].concat(s);\n\n  r = rmPadding(r);\n  s = rmPadding(s);\n\n  while (!s[0] && !(s[1] & 0x80)) {\n    s = s.slice(1);\n  }\n  var arr = [ 0x02 ];\n  constructLength(arr, r.length);\n  arr = arr.concat(r);\n  arr.push(0x02);\n  constructLength(arr, s.length);\n  var backHalf = arr.concat(s);\n  var res = [ 0x30 ];\n  constructLength(res, backHalf.length);\n  res = res.concat(backHalf);\n  return utils.encode(res, enc);\n};\n"]},"metadata":{},"sourceType":"script"}