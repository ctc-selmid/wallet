{"ast":null,"code":"var md5=require('create-hash/md5');var RIPEMD160=require('ripemd160');var sha=require('sha.js');var Buffer=require('safe-buffer').Buffer;var checkParameters=require(\"./precondition\");var defaultEncoding=require(\"./default-encoding\");var toBuffer=require(\"./to-buffer\");var ZEROS=Buffer.alloc(128);var sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function Hmac(alg,key,saltLen){var hash=getDigest(alg);var blocksize=alg==='sha512'||alg==='sha384'?128:64;if(key.length>blocksize){key=hash(key);}else if(key.length<blocksize){key=Buffer.concat([key,ZEROS],blocksize);}var ipad=Buffer.allocUnsafe(blocksize+sizes[alg]);var opad=Buffer.allocUnsafe(blocksize+sizes[alg]);for(var i=0;i<blocksize;i++){ipad[i]=key[i]^0x36;opad[i]=key[i]^0x5C;}var ipad1=Buffer.allocUnsafe(blocksize+saltLen+4);ipad.copy(ipad1,0,0,blocksize);this.ipad1=ipad1;this.ipad2=ipad;this.opad=opad;this.alg=alg;this.blocksize=blocksize;this.hash=hash;this.size=sizes[alg];}Hmac.prototype.run=function(data,ipad){data.copy(ipad,this.blocksize);var h=this.hash(ipad);h.copy(this.opad,this.blocksize);return this.hash(this.opad);};function getDigest(alg){function shaFunc(data){return sha(alg).update(data).digest();}function rmd160Func(data){return new RIPEMD160().update(data).digest();}if(alg==='rmd160'||alg==='ripemd160')return rmd160Func;if(alg==='md5')return md5;return shaFunc;}function pbkdf2(password,salt,iterations,keylen,digest){checkParameters(iterations,keylen);password=toBuffer(password,defaultEncoding,'Password');salt=toBuffer(salt,defaultEncoding,'Salt');digest=digest||'sha1';var hmac=new Hmac(digest,password,salt.length);var DK=Buffer.allocUnsafe(keylen);var block1=Buffer.allocUnsafe(salt.length+4);salt.copy(block1,0,0,salt.length);var destPos=0;var hLen=sizes[digest];var l=Math.ceil(keylen/hLen);for(var i=1;i<=l;i++){block1.writeUInt32BE(i,salt.length);var T=hmac.run(block1,hmac.ipad1);var U=T;for(var j=1;j<iterations;j++){U=hmac.run(U,hmac.ipad2);for(var k=0;k<hLen;k++){T[k]^=U[k];}}T.copy(DK,destPos);destPos+=hLen;}return DK;}module.exports=pbkdf2;","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/pbkdf2/lib/sync-browser.js"],"names":["md5","require","RIPEMD160","sha","Buffer","checkParameters","defaultEncoding","toBuffer","ZEROS","alloc","sizes","sha1","sha224","sha256","sha384","sha512","rmd160","ripemd160","Hmac","alg","key","saltLen","hash","getDigest","blocksize","length","concat","ipad","allocUnsafe","opad","i","ipad1","copy","ipad2","size","prototype","run","data","h","shaFunc","update","digest","rmd160Func","pbkdf2","password","salt","iterations","keylen","hmac","DK","block1","destPos","hLen","l","Math","ceil","writeUInt32BE","T","U","j","k","module","exports"],"mappings":"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","sourcesContent":["var md5 = require('create-hash/md5')\nvar RIPEMD160 = require('ripemd160')\nvar sha = require('sha.js')\nvar Buffer = require('safe-buffer').Buffer\n\nvar checkParameters = require('./precondition')\nvar defaultEncoding = require('./default-encoding')\nvar toBuffer = require('./to-buffer')\n\nvar ZEROS = Buffer.alloc(128)\nvar sizes = {\n  md5: 16,\n  sha1: 20,\n  sha224: 28,\n  sha256: 32,\n  sha384: 48,\n  sha512: 64,\n  rmd160: 20,\n  ripemd160: 20\n}\n\nfunction Hmac (alg, key, saltLen) {\n  var hash = getDigest(alg)\n  var blocksize = (alg === 'sha512' || alg === 'sha384') ? 128 : 64\n\n  if (key.length > blocksize) {\n    key = hash(key)\n  } else if (key.length < blocksize) {\n    key = Buffer.concat([key, ZEROS], blocksize)\n  }\n\n  var ipad = Buffer.allocUnsafe(blocksize + sizes[alg])\n  var opad = Buffer.allocUnsafe(blocksize + sizes[alg])\n  for (var i = 0; i < blocksize; i++) {\n    ipad[i] = key[i] ^ 0x36\n    opad[i] = key[i] ^ 0x5C\n  }\n\n  var ipad1 = Buffer.allocUnsafe(blocksize + saltLen + 4)\n  ipad.copy(ipad1, 0, 0, blocksize)\n  this.ipad1 = ipad1\n  this.ipad2 = ipad\n  this.opad = opad\n  this.alg = alg\n  this.blocksize = blocksize\n  this.hash = hash\n  this.size = sizes[alg]\n}\n\nHmac.prototype.run = function (data, ipad) {\n  data.copy(ipad, this.blocksize)\n  var h = this.hash(ipad)\n  h.copy(this.opad, this.blocksize)\n  return this.hash(this.opad)\n}\n\nfunction getDigest (alg) {\n  function shaFunc (data) {\n    return sha(alg).update(data).digest()\n  }\n  function rmd160Func (data) {\n    return new RIPEMD160().update(data).digest()\n  }\n\n  if (alg === 'rmd160' || alg === 'ripemd160') return rmd160Func\n  if (alg === 'md5') return md5\n  return shaFunc\n}\n\nfunction pbkdf2 (password, salt, iterations, keylen, digest) {\n  checkParameters(iterations, keylen)\n  password = toBuffer(password, defaultEncoding, 'Password')\n  salt = toBuffer(salt, defaultEncoding, 'Salt')\n\n  digest = digest || 'sha1'\n\n  var hmac = new Hmac(digest, password, salt.length)\n\n  var DK = Buffer.allocUnsafe(keylen)\n  var block1 = Buffer.allocUnsafe(salt.length + 4)\n  salt.copy(block1, 0, 0, salt.length)\n\n  var destPos = 0\n  var hLen = sizes[digest]\n  var l = Math.ceil(keylen / hLen)\n\n  for (var i = 1; i <= l; i++) {\n    block1.writeUInt32BE(i, salt.length)\n\n    var T = hmac.run(block1, hmac.ipad1)\n    var U = T\n\n    for (var j = 1; j < iterations; j++) {\n      U = hmac.run(U, hmac.ipad2)\n      for (var k = 0; k < hLen; k++) T[k] ^= U[k]\n    }\n\n    T.copy(DK, destPos)\n    destPos += hLen\n  }\n\n  return DK\n}\n\nmodule.exports = pbkdf2\n"]},"metadata":{},"sourceType":"script"}