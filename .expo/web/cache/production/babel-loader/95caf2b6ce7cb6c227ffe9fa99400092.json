{"ast":null,"code":"import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{nanoid}from'nanoid/non-secure';import TabRouter,{TabActions}from\"./TabRouter\";export var DrawerActions=_objectSpread(_objectSpread({},TabActions),{},{openDrawer:function openDrawer(){return{type:'OPEN_DRAWER'};},closeDrawer:function closeDrawer(){return{type:'CLOSE_DRAWER'};},toggleDrawer:function toggleDrawer(){return{type:'TOGGLE_DRAWER'};}});var isDrawerOpen=function isDrawerOpen(state){var _state$history;return Boolean((_state$history=state.history)===null||_state$history===void 0?void 0:_state$history.some(function(it){return it.type==='drawer';}));};var openDrawer=function openDrawer(state){if(isDrawerOpen(state)){return state;}return _objectSpread(_objectSpread({},state),{},{history:[].concat(_toConsumableArray(state.history),[{type:'drawer'}])});};var closeDrawer=function closeDrawer(state){if(!isDrawerOpen(state)){return state;}return _objectSpread(_objectSpread({},state),{},{history:state.history.filter(function(it){return it.type!=='drawer';})});};export default function DrawerRouter(_ref){var openByDefault=_ref.openByDefault,rest=_objectWithoutProperties(_ref,[\"openByDefault\"]);var router=TabRouter(rest);return _objectSpread(_objectSpread({},router),{},{type:'drawer',getInitialState:function getInitialState(_ref2){var routeNames=_ref2.routeNames,routeParamList=_ref2.routeParamList;var state=router.getInitialState({routeNames:routeNames,routeParamList:routeParamList});if(openByDefault){state=openDrawer(state);}return _objectSpread(_objectSpread({},state),{},{stale:false,type:'drawer',key:\"drawer-\".concat(nanoid())});},getRehydratedState:function getRehydratedState(partialState,_ref3){var routeNames=_ref3.routeNames,routeParamList=_ref3.routeParamList;if(partialState.stale===false){return partialState;}var state=router.getRehydratedState(partialState,{routeNames:routeNames,routeParamList:routeParamList});if(isDrawerOpen(partialState)){state=openDrawer(state);}return _objectSpread(_objectSpread({},state),{},{type:'drawer',key:\"drawer-\".concat(nanoid())});},getStateForRouteFocus:function getStateForRouteFocus(state,key){var result=router.getStateForRouteFocus(state,key);if(openByDefault){return openDrawer(result);}return closeDrawer(result);},getStateForAction:function getStateForAction(state,action,options){switch(action.type){case'OPEN_DRAWER':return openDrawer(state);case'CLOSE_DRAWER':return closeDrawer(state);case'TOGGLE_DRAWER':if(isDrawerOpen(state)){return closeDrawer(state);}return openDrawer(state);case'GO_BACK':if(openByDefault){if(!isDrawerOpen(state)){return openDrawer(state);}}else{if(isDrawerOpen(state)){return closeDrawer(state);}}return router.getStateForAction(state,action,options);default:return router.getStateForAction(state,action,options);}},actionCreators:DrawerActions});}","map":{"version":3,"sources":["DrawerRouter.tsx"],"names":["DrawerActions","openDrawer","type","closeDrawer","toggleDrawer","isDrawerOpen","state","Boolean","it","history","rest","router","TabRouter","getInitialState","routeParamList","routeNames","stale","key","nanoid","getRehydratedState","partialState","getStateForRouteFocus","result","getStateForAction","action","actionCreators"],"mappings":"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","sourcesContent":["import { nanoid } from 'nanoid/non-secure';\nimport type {\n  PartialState,\n  CommonNavigationAction,\n  Router,\n  ParamListBase,\n} from './types';\nimport TabRouter, {\n  TabActions,\n  TabActionType,\n  TabRouterOptions,\n  TabNavigationState,\n  TabActionHelpers,\n} from './TabRouter';\n\nexport type DrawerActionType =\n  | TabActionType\n  | {\n      type: 'OPEN_DRAWER' | 'CLOSE_DRAWER' | 'TOGGLE_DRAWER';\n      source?: string;\n      target?: string;\n    };\n\nexport type DrawerRouterOptions = TabRouterOptions & {\n  openByDefault?: boolean;\n};\n\nexport type DrawerNavigationState<ParamList extends ParamListBase> = Omit<\n  TabNavigationState<ParamList>,\n  'type' | 'history'\n> & {\n  /**\n   * Type of the router, in this case, it's drawer.\n   */\n  type: 'drawer';\n  /**\n   * List of previously visited route keys and drawer open status.\n   */\n  history: ({ type: 'route'; key: string } | { type: 'drawer' })[];\n};\n\nexport type DrawerActionHelpers<\n  ParamList extends ParamListBase\n> = TabActionHelpers<ParamList> & {\n  /**\n   * Open the drawer sidebar.\n   */\n  openDrawer(): void;\n\n  /**\n   * Close the drawer sidebar.\n   */\n  closeDrawer(): void;\n\n  /**\n   * Open the drawer sidebar if closed, or close if opened.\n   */\n  toggleDrawer(): void;\n};\n\nexport const DrawerActions = {\n  ...TabActions,\n  openDrawer(): DrawerActionType {\n    return { type: 'OPEN_DRAWER' };\n  },\n  closeDrawer(): DrawerActionType {\n    return { type: 'CLOSE_DRAWER' };\n  },\n  toggleDrawer(): DrawerActionType {\n    return { type: 'TOGGLE_DRAWER' };\n  },\n};\n\nconst isDrawerOpen = (\n  state:\n    | DrawerNavigationState<ParamListBase>\n    | PartialState<DrawerNavigationState<ParamListBase>>\n) => Boolean(state.history?.some((it) => it.type === 'drawer'));\n\nconst openDrawer = (\n  state: DrawerNavigationState<ParamListBase>\n): DrawerNavigationState<ParamListBase> => {\n  if (isDrawerOpen(state)) {\n    return state;\n  }\n\n  return {\n    ...state,\n    history: [...state.history, { type: 'drawer' }],\n  };\n};\n\nconst closeDrawer = (\n  state: DrawerNavigationState<ParamListBase>\n): DrawerNavigationState<ParamListBase> => {\n  if (!isDrawerOpen(state)) {\n    return state;\n  }\n\n  return {\n    ...state,\n    history: state.history.filter((it) => it.type !== 'drawer'),\n  };\n};\n\nexport default function DrawerRouter({\n  openByDefault,\n  ...rest\n}: DrawerRouterOptions): Router<\n  DrawerNavigationState<ParamListBase>,\n  DrawerActionType | CommonNavigationAction\n> {\n  const router = (TabRouter(rest) as unknown) as Router<\n    DrawerNavigationState<ParamListBase>,\n    TabActionType | CommonNavigationAction\n  >;\n\n  return {\n    ...router,\n\n    type: 'drawer',\n\n    getInitialState({ routeNames, routeParamList }) {\n      let state = router.getInitialState({ routeNames, routeParamList });\n\n      if (openByDefault) {\n        state = openDrawer(state);\n      }\n\n      return {\n        ...state,\n        stale: false,\n        type: 'drawer',\n        key: `drawer-${nanoid()}`,\n      };\n    },\n\n    getRehydratedState(partialState, { routeNames, routeParamList }) {\n      if (partialState.stale === false) {\n        return partialState;\n      }\n\n      let state = router.getRehydratedState(partialState, {\n        routeNames,\n        routeParamList,\n      });\n\n      if (isDrawerOpen(partialState)) {\n        state = openDrawer(state);\n      }\n\n      return {\n        ...state,\n        type: 'drawer',\n        key: `drawer-${nanoid()}`,\n      };\n    },\n\n    getStateForRouteFocus(state, key) {\n      const result = router.getStateForRouteFocus(state, key);\n\n      if (openByDefault) {\n        return openDrawer(result);\n      }\n\n      return closeDrawer(result);\n    },\n\n    getStateForAction(state, action, options) {\n      switch (action.type) {\n        case 'OPEN_DRAWER':\n          return openDrawer(state);\n\n        case 'CLOSE_DRAWER':\n          return closeDrawer(state);\n\n        case 'TOGGLE_DRAWER':\n          if (isDrawerOpen(state)) {\n            return closeDrawer(state);\n          }\n\n          return openDrawer(state);\n\n        case 'GO_BACK':\n          if (openByDefault) {\n            if (!isDrawerOpen(state)) {\n              return openDrawer(state);\n            }\n          } else {\n            if (isDrawerOpen(state)) {\n              return closeDrawer(state);\n            }\n          }\n\n          return router.getStateForAction(state, action, options);\n\n        default:\n          return router.getStateForAction(state, action, options);\n      }\n    },\n\n    actionCreators: DrawerActions,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}